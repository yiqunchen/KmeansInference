<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Selective inference for k-means clustering ‚Ä¢ KmeansInference</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Selective inference for k-means clustering">
<meta property="og:description" content="An implementation for a difference-in-means test between clusters of observations identified via k-means clustering, as described in Chen and Witten (2022+)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">KmeansInference</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/technical_details.html">Technical details</a>
</li>
<li>
  <a href="articles/Tutorials.html">Software tutorials</a>
</li>
<li>
  <a href="articles/real_data_example.html">Real data example</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="kmeansinference-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#kmeansinference-" class="anchor"></a>KmeansInference <img src="reference/figures/sticker.png" align="right" width="150px">
</h1></div>
<div id="what-is-kmeansinference" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-kmeansinference" class="anchor"></a>What is KmeansInference?</h3>
<p><code>KmeansInference</code> is an <code>R</code> package for testing for a difference in means between clusters of observations identified via k-means clustering.</p>
</div>
<div id="how-do-i-install-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#how-do-i-install-the-package" class="anchor"></a>How do I install the package?</h3>
<p>To download (and load) the KmeansInference package, use the code below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/">"devtools"</a></span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"yiqunchen/KmeansInference"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">KmeansInference</span><span class="op">)</span></code></pre></div>
</div>
<div id="why-do-we-need-kmeansinference" class="section level3">
<h3 class="hasAnchor">
<a href="#why-do-we-need-kmeansinference" class="anchor"></a>Why do we need KmeansInference?</h3>
<p>Testing for a difference in means between two groups is one of the most fundamental task in statistics, with numerous applications. If the groups under investigation are <em>pre-specified</em>, i.e., without making use of the observed data, then classical hypothesis tests will control the Type I error rate.</p>
<p>However, in practice, data analysts often find themselves testing the null hypothesis of a difference in means between two groups that are <em>defined through the same data</em> used for testing, e.g., via the output of a clustering algorithm. For instance, in single-cell RNA-sequencing analysis, researchers often first cluster the cells, and then test for a difference in the mean gene expression levels between the clusters to quantify up- or down-regulation of genes and identify new cell types. In this case, because the groups are defined through the data, classical hypothesis tests lead to an <em>inflated Type I error</em>.</p>
<p>In particular, the inferential challenges resulting from testing data-guided hypotheses have been described as a ‚Äúgrand challenge‚Äù in the field of genomics (L√§hnemann et al., 2020), and papers in the field continue to overlook this issue: as an example, seurat (Stuart et al., 2019), the state-of-the-art single-cell RNA sequencing analysis tool that has been cited more than 3,900 times since 2019, tests for differential gene expressed between groups obtained via clustering, with a note that ‚Äú<em>p-values [from these hypotheses] should be interpreted cautiously, as the genes used for clustering are the same genes tested for differential expression.</em>‚Äù</p>
<p>In this work, we propose a test for a difference in means between two clusters estimated from applying <strong>k-means clustering</strong>. Given a set of observations, suppose that we first apply apply the k-means clustering to obtain clusters. We might then consider testing the null hypothesis that the mean is the same across two <em>estimated clusters</em>. As an example, consider a simulated data set where <span class="math inline"><em>x</em><sub>1</sub>,‚ÄÜ‚Ä¶,‚ÄÜ<em>x</em><sub>150</sub>‚ÄÑ‚àº‚ÄÑùí©(<strong>0</strong><sub>2</sub>,<strong>I</strong><sub>2</sub>)</span>, and applying the k-means clustering with K=3 yields three clusters (see leftmost panel of Figure 1). In the middle panel, we display the quantiles of the Wald p-value for testing the null hypothesis that a randomly chosen pair of <em>estimated clusters</em> have the same mean. Because the Wald p-value does not account for the fact that the cluster labels are obtained through the same data used for testing, the test based on it leads to an extremely inflated Type I error. By contrast, our selective p-value, conditional on the event that k-means clustering yields the two estimated clusters under investigation, leads to a correctly-sized test (see the rightmost panel of Figure 1). More detailed simulation results can be found in Section 2 of our manuscript.</p>
<div>
<figure><img src="reference/figures/figure_1_a.png" alt="Illustrative example" width="30%" class="center"><img src="reference/figures/figure_1_b.png" alt="1b" width="30%" class="center"><img src="reference/figures/figure_1_c.png" alt="1c" width="30%" class="center"></figure><!-- [Figure 1: (a): The piecewise mean structure of $\beta$ according to a two-dimensional grid graph. (b): Under the null hypothesis, both $p_{\text{Hyun}}$ and $p_{C_1,C_2}$ control the selective Type I error, but the z-test $p_{\text{Naive}} = \mathbb{P}(|\nu^\top Y|\geq |\nu^\top y|)$ leads to inflated selective Type I error. (c): For a given value of the effect size ($|\nu^\top\beta|/\sigma$), $p_{C_1,C_2}$ has higher power than $p_{\text{Hyun}}$. Power for both increases as a function of the effect size.] -->
</div>
<div id="link-to-additional-resources" class="section level3">
<h3 class="hasAnchor">
<a href="#link-to-additional-resources" class="anchor"></a>Link to additional resources</h3>
<ul>
<li>You can learn more about the technical details in our manuscript and in the <a href="https://yiqunchen.github.io/GFLassoInference/articles/technical_details.html">technical details section</a>.</li>
<li>You can learn more about how to use our software in the <a href="https://yiqunchen.github.io/GFLassoInference/articles/Tutorials.html">tutorials section</a>.</li>
<li>Finally, code and steps to reproduce the figures in our manuscript can be found in the GitHub repo <a href="https://github.com/yiqunchen/GFLassoInference-experiments">https://github.com/yiqunchen/GFLassoInference-experiments</a>.</li>
</ul>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h3>
<p>If you use <code>KmeansInference</code> for your analysis, please cite our manuscript:</p>
<p>Chen YT, Witten DM. (2022+) Selective inference for k-means clustering. arXiv preprint. <a href="https://arxiv.org/abs/xxxx.xxxxx" class="uri">https://arxiv.org/abs/xxxx.xxxxx</a>.</p>
</div>
<div id="bug-reports--change-requests" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-reports--change-requests" class="anchor"></a>Bug Reports / Change Requests</h3>
<p>If you encounter a bug or would like to make a change request, please file it as an issue <a href="https://github.com/yiqunchen/KmeansInference/issues">here</a>.</p>
</div>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Chen YT, Witten DM. (2022+) Selective inference for k-means clustering. arXiv preprint. <a href="https://arxiv.org/abs/xxxx.xxxxx" class="uri">https://arxiv.org/abs/xxxx.xxxxx</a>.</p>
<p>Fithian W, Sun D, Taylor J. (2014) Optimal Inference After Model Selection. arXiv:1410.2597 [mathST].</p>
<p>Gao, L. L., Bien, J., and Witten, D. (2022+). Selective inference for hierarchical clustering. arXiv:2012.02936.</p>
<p>L√§hnemann, D., K√∂ster, J., Szczurek, E., et al.¬†(2020). Eleven grand challenges in single-cell data science. Genome Biology, 21(1):31.</p>
<p>Stuart, T., Butler, A., Hoffman, P., et al.¬†(2019). Comprehensive integration of Single-Cell data. Cell, 177(7):1888‚Äì1902.e21.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yiqun Chen <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Yiqun Chen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
